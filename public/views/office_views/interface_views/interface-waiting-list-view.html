<link rel="import" href="/bower_components/polymer/polymer.html">

<link rel="import" href="/bower_components/paper-button/paper-button.html">
<link rel="import" href="/bower_components/paper-material/paper-material.html">
<link rel="import" href="/bower_components/iron-collapse/iron-collapse.html">
<link rel="import" href="/bower_components/iron-flex-layout/iron-flex-layout.html">

<link rel="import" href="/styles/button-styles.html">
<link rel="import" href="/styles/interface-styles.html">

<dom-module id="interface-waiting-list-view">
    <template>
        <style include="interface-styles button-styles">


            #current_patient {
                background-color: var(--app-green-color);
                color: #fff;
                padding: 0.8em 1.5em;
                display: inline-block;
                margin-bottom: -1px; /*to cover border od patient_div */
            }

            .my-list-item {
                border: 1px solid var(--border-color);
                margin: 1em 0 0 0;
            }

            .collapse-content {
                background-color: #fff;
                padding: 1.2em;
                border-left: 1px solid var(--border-color);
                border-right: 1px solid var(--border-color);
                border-bottom: 1px solid var(--border-color);
            }

            .time {
                margin-right: 1em;
                font-weight: bold;
            }


            /* FIRST PATIENT CSS DIFFERENCES */

            .my-list-item:nth-child(2) {
                margin-top: 0;
                box-shadow: 0 14px 28px rgba(0,0,0,0.15), 0 10px 10px rgba(0,0,0,0.12);
            }

            .my-list-item:nth-child(2) paper-button {
                box-shadow: 0 3px 6px rgba(0,0,0,0.16), 0 3px 6px rgba(0,0,0,0.23);
            }

            .my-list-item:nth-child(2) .confirm-button {
                background-color: var(--app-green-color);
                border-color: var(--app-green-color);
                color: #fff;
            }

            .my-list-item:nth-child(2) .dismiss-button {
                background-color: var(--app-red-color);
                border-color: var(--app-red-color);
                color: #fff;
            }

            .my-list-item:nth-child(2) .details-button {
                background-color: var(--app-accent-color);
                border-color: var(--app-accent-color);
                color: #fff;
            }


            /* FLEX LAYOUT */
            .flex-horizontal-with-ratios {
                @apply(--layout-horizontal);
            }

            .flexchild {
                @apply(--layout-flex);
                margin-right: 2em;
            }

            .flex2child {
                @apply(--layout-flex);
            }

            .flex3child {
                @apply(--layout-flex-2);
                text-align: right;
            }

            /*RESPONSIVE ADDITIONS*/
            @media only screen and (max-width: 1180px) {

                .flex-horizontal-with-ratios {
                    @apply(--layout-vertical);
                }

                .flex-horizontal-with-ratios > div {
                    margin: 0.2em 0;
                }

                .flex3child {
                    border-top: 1px solid #ddd;
                    padding-top: 0.6em;
                }

                .my-list-item {
                    padding-bottom: 0.5em;
                }

                .details-button{
                    float: left;
                }

            }


            @media only screen and (max-width: 382px) {

                .details-button{
                    float: none;
                }

                .buttons > paper-button {
                    display: block;
                    margin: 0.9em 0;
                    text-align: center;
                    padding: 1.2em;
                }

                .my-list-item {
                    border: 1px solid var(--border-color);
                    margin-top: 2em;
                }
            }

        </style>

        <div id="current_patient">Pacient na řadě</div>

        <template is="dom-repeat" items="[[patients]]" as="patient">

            <div class="container flex-horizontal-with-ratios my-list-item">
                <div class="time">[[patient.time]]</div>
                <div class="flexchild">[[patient.firstName]] [[patient.lastName]]</div>
                <div class="flex2child">[[patient.address]]</div>
                <div class="flex3child buttons">

                    <paper-button hidden="[[!patient.text]]" on-tap="handleDetail" class="details-button">
                        [[computeText(patient.opened)]] detail
                    </paper-button>
                    <paper-button class="confirm-button">Vyřízen</paper-button>
                    <paper-button class="dismiss-button">Nedorazil</paper-button>
                </div>
            </div>

            <iron-collapse opened="[[patient.opened]]">
                <div class="collapse-content">
                    <div class="text">[[patient.text]]</div>
                </div>
            </iron-collapse>
        </template>

    </template>

    <script>
        Polymer({
            is: 'interface-waiting-list-view',

            properties: {
                patients: {
                    type: Array,
                    value: [
                        {
                            firstName: "Robert",
                            lastName: "Brada",
                            address: "Kardinála Berana 13, Plzeň",
                            time: "7:30",
                            text: "Je mi špatně a teče mi hnis z oka.",
                            opened: false
                        },
                        {
                            firstName: "Michaelinsaknfdadc",
                            lastName: "Aubreyisbaddmafdrf",
                            address: "St. Church 123, London",
                            time: "8:00",
                            text: null,
                            opened: false
                        },
                        {
                            firstName: null,
                            lastName: "Elliot",
                            time: "8:30",
                            address: null,
                            text: null,
                            opened: false
                        },
                        {
                            firstName: "Stephen",
                            lastName: "Maturin",
                            time: "9:00",
                            address: "Dvůr Králové nad Labem, Sady pětatřicátníků 28",
                            text: "Potřeboval bych vyplnit nějaká lejstra a předepsat steroidy, protože chci být obrovkej.",
                            opened: false
                        },
                        {
                            firstName: "Stephen",
                            lastName: "Maturin",
                            time: "9:00",
                            address: "Franz Joseph Sp. Strase 15, Wangen",
                            text: "Potřeboval bych vyplnit nějaká lejstra a předepsat steroidy, protože chci být obrovkej.",
                            opened: false

                        }
                    ]
                }
            },

            computeText: function (opened) {
                return (opened) ? "Skrýt" : "Zobrazit";
            },

            handleDetail: function (event) {
                var opened = event.model.patient.opened;
                event.model.set('patient.opened', !opened);
            }

        });
    </script>
</dom-module>
