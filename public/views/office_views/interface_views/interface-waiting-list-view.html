<link rel="import" href="/bower_components/polymer/polymer.html">

<link rel="import" href="/bower_components/paper-button/paper-button.html">
<link rel="import" href="/bower_components/iron-collapse/iron-collapse.html">
<link rel="import" href="/bower_components/iron-flex-layout/iron-flex-layout.html">
<link rel="import" href="/bower_components/iron-media-query/iron-media-query.html">

<link rel="import" href="/styles/button-styles.html">
<link rel="import" href="/styles/interface-styles.html">

<dom-module id="interface-waiting-list-view">
    <template>
        <style include="interface-styles button-styles">

            .my-list-item {
                border: 1px solid var(--border-color);
                margin: 1.2em 0 0 0;
            }

            #current_patient {
                background-color: var(--app-green-color);
                color: #fff;
                padding: 0.8em 1.5em;
                display: inline-block;
                margin-bottom: -1px;
            }

            .time {
                margin-right: 2em;
                font-size: 1.1em;
                font-weight: bold;
                color: var(--app-green-color);

            }

            .in-waiting-room {
                padding: 0.6em;
                color: #828292;
                background-color: #eeeff2;
                text-align: center;
                border: 1px solid var(--border-color);
            }

            /* FIRST PATIENT CSS DIFFERENCES */

            .my-list-item:nth-child(4) {
                margin-top: 0;
                box-shadow: 0 14px 28px rgba(0, 0, 0, 0.15), 0 10px 10px rgba(0, 0, 0, 0.12);
            }

            .my-list-item:nth-child(4) paper-button {
                box-shadow: 0 3px 6px rgba(0, 0, 0, 0.16), 0 3px 6px rgba(0, 0, 0, 0.23);
            }

            .my-list-item:nth-child(4) .confirm-button {
                background-color: var(--app-green-color);
                border-color: var(--app-green-color);
                color: #fff;
            }

            .my-list-item:nth-child(4) .dismiss-button {
                background-color: var(--app-red-color);
                border-color: var(--app-red-color);
                color: #fff;
            }

            .my-list-item:nth-child(4) .details-button {
                background-color: var(--app-accent-color);
                border-color: var(--app-accent-color);
                color: #fff;
            }

            /* FLEX LAYOUT */
            .name, .address {
                max-width: 15%;
            }

            /*RESPONSIVE ADDITIONS*/
            @media only screen and (max-width: 1410px) {

                .flex-horizontal-with-ratios {
                    @apply(--layout-vertical);
                }

                .name, .address {
                    max-width: 100%;
                }

                .my-list-item {
                    padding-bottom: 0.5em;
                }

                .details-button {
                    float: left;
                }

                .label {
                    display: inline-block;
                    margin: 0.25em 0.5em 0.25em 0;
                }

                .address-city{
                    margin-left: 3.51em;
                    display: inline-block;
                }

                .buttons {
                    border-top: 1px solid var(--border-color);
                    padding-top: 0.6em;
                    margin-top: 1em;
                }
            }

            @media only screen and (max-width: 435px) {

                .details-button {
                    float: none;
                }

                .buttons > paper-button {
                    margin: 0 0.9%;
                    width: 30.8%;
                }

                .my-list-item {
                    border: 1px solid var(--border-color);
                    margin-top: 2em;
                }
            }

        </style>

        <iron-media-query query="max-width: 435px" query-matches="{{mobileScreen}}"></iron-media-query>
        <iron-media-query query="max-width: 1410px" query-matches="{{smallScreen}}"></iron-media-query>

        <div id="current_patient">Pacient na řadě</div>

        <template is="dom-repeat" items="[[patients]]" as="patient">

            <div class="container flex-horizontal-with-ratios my-list-item">
                <div class="time">[[patient.time]]</div>

                <div class="flexchild name"><span class="label">Jméno:</span>[[patient.firstName]] [[patient.lastName]]
                </div>

                <div class="flexchild date-of-birth" hidden="[[!patient.dateOfBirth]]"><span class="label">Datum narození:</span>[[patient.dateOfBirth]]
                </div>

                <!--zobrazi se kdyz chybi datum narozeni (je v cekarne), az bude krabicek tak bude asi jine kriterium-->
                <div class="flex3child in-waiting-room" hidden="[[patient.dateOfBirth]]">Pacient v čekárně</div>

                <div class="flex2child address" hidden="[[!patient.addressStreet]]"><span class="label">Adresa:</span>[[patient.addressStreet]]
                    <br><div class="address-city">[[patient.addressCity]]</div>
                </div>

                <div class="flex3child buttons">

                    <paper-button hidden="[[!patient.text]]" on-tap="handleDetail" class="details-button">
                        <iron-icon icon="icons:info-outline"></iron-icon>
                        <span hidden="[[mobileScreen]]">[[computeText(patient.opened)]] zprávu</span>
                    </paper-button>
                    <paper-button class="confirm-button">
                        <iron-icon icon="icons:check"></iron-icon>
                        <span hidden="[[mobileScreen]]">Vyřízen</span></paper-button>
                    <paper-button class="dismiss-button">
                        <iron-icon icon="icons:close"></iron-icon>
                        <span hidden="[[mobileScreen]]">Nedorazil</span></paper-button>
                </div>
            </div>

            <iron-collapse opened="[[patient.opened]]">
                <div class="collapse-content">
                    <div class="text">[[patient.text]]</div>
                </div>
            </iron-collapse>
        </template>

    </template>

    <script>
        Polymer({
            is: 'interface-waiting-list-view',

            properties: {
                patients: {
                    type: Array,
                    value: [
                        {
                            time: "7:30",
                            firstName: "Robert",
                            lastName: "Brada",
                            dateOfBirth: "2.2.1995",
                            addressCity: "Plzeň",
                            addressStreet: "Kardinála Berana 13",
                            text: "Je mi špatně a teče mi hnis z oka.",
                            opened: false
                        },
                        {
                            time: "8:00",
                            firstName: "Michaelinsaknfdadc",
                            lastName: "Aubreyisbaddmafdrf",
                            dateOfBirth: "13.11.1999",
                            addressCity: "London",
                            addressStreet: "St. Church 123",
                            text: null,
                            opened: false
                        },
                        {
                            time: "8:30",
                            firstName: null,
                            lastName: "Elliot",
                            dateOfBirth: null,
                            addressCity: null,
                            addressStreet: null,
                            address: null,
                            text: null,
                            opened: false
                        },
                        {
                            time: "9:00",
                            firstName: "Stephen",
                            lastName: "Maturin",
                            dateOfBirth: "2.10.1986",
                            addressCity: "Dvůr Králové nad Labem",
                            addressStreet: "Sady pětatřicátníků 28",
                            text: "Potřeboval bych vyplnit nějaká lejstra a předepsat steroidy, protože chci být obrovkej.",
                            opened: false
                        },
                        {
                            time: "9:00",
                            firstName: "Stephen",
                            lastName: "Maturin",
                            dateOfBirth: "20.9.1995",
                            addressCity: "Wangen",
                            addressStreet: "Franz Joseph Sp. Strase 15",
                            text: "Potřeboval bych vyplnit nějaká lejstra a předepsat steroidy, protože chci být obrovkej.",
                            opened: false

                        }
                    ]
                }
            },

            computeText: function (opened) {
                return (opened) ? "Skrýt" : "Zobrazit";
            },

            handleDetail: function (event) {
                var opened = event.model.patient.opened;
                event.model.set('patient.opened', !opened);
            }

        });
    </script>
</dom-module>
