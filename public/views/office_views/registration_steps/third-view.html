<link rel="import" href="/bower_components/polymer/polymer.html">

<link rel="import" href="/bower_components/paper-date-picker-item/paper-datetime-picker-item.html">
<link rel="import" href="/bower_components/paper-input/paper-input.html">
<link rel="import" href="/bower_components/paper-checkbox/paper-checkbox.html">
<link rel="import" href="/bower_components/iron-icons/iron-icons.html">
<link rel="import" href="/bower_components/iron-flex-layout/iron-flex-layout.html">

<link rel="import" href="/styles/input-styles.html">
<link rel="import" href="/styles/layout-styles.html">

<link rel="import" href="/behaviors/form-validation-behavior.html">

<dom-module id="third-view">
    <template>
        <style include="layout-styles input-styles">

            paper-checkbox#online-booking-checkbox {
                border: 1px solid var(--app-accent-color);
                padding: 0.6em 1.6em;
                font-weight: bolder;
                background-color: var(--app-accent-color);
                letter-spacing: 0.03em;
                --paper-checkbox-unchecked-color: white;
                --paper-checkbox-label-color: white;
                --paper-checkbox-size: 22px;
                --paper-checkbox-margin: 8px 10px 8px 0;
            }

            paper-checkbox#onlineSection {
                font-weight: bolder;
                --paper-checkbox-unchecked-color: var(--app-green-color);
                --paper-checkbox-label-color:  var(--app-green-color);
                --paper-checkbox-size: 18px;
            }

            #online-booking-container {
                text-align: left;
                margin-bottom: 2em;
            }

            #not-online-container paper-checkbox {
                width: 6em;
                margin-top: 2em;
            }

            .flex-horizontal {
                @apply(--layout-horizontal);
            }

            .flexchild {
                @apply(--layout-flex);
            }

            #not-online-container paper-input {
                width: 100%;
                margin-left: 2em;
                --paper-input-container: {
                    width: 100%;
                };

                --paper-input-container-input: {
                    width: 100%;
                }
            }

            #online-header{
                margin-top: 2.5em;
                padding-top: 1em;
                border-top: 1px solid #d5d5d6;
                margin-bottom: 3.5em;
            }

            #online-header  h1{
                font-size: 1.3em;
                color: var(--app-green-color);
            }

            @media only screen and (max-width: 767px) {

                .flex-horizontal {
                    @apply(--layout-vertical);
                }

                #online-booking-container {
                    text-align: center;
                    margin-top: 2em;
                }

                #not-online-container paper-input {
                    margin-left: 0;
                }
            }

        </style>

        <div class="main-frame">
            <form is="iron-form">
                <div class="subsection grid">
                    <section>
                        <h2>Ordinační hodiny</h2>
                        <p>Zadejte své ordinační hodiny. Pokud máte hodiny nějak rozdělené, tak můžete úvést
                            popis. Tyto informace budou k vidění na vašem profilu.</p>
                        <template is="dom-repeat" items="[[officeData.generatorInfo.officeHours]]" as="entry">
                            <div id="not-online-container" class="flex-horizontal">
                                <paper-checkbox class="" checked="{{entry.available}}">[[getDayName(index)]]
                                </paper-checkbox>

                                <template is="dom-if" if="[[entry.available]]" restamp="true">
                                    <paper-input class=flexchild" value="{{entry.hours}}" auto-validate required
                                                 placeholder="7:00-8:00 objednaní, 10:00-12:00 náběr krve,..."
                                    ></paper-input>
                                </template>
                            </div>
                        </template>
                    </section>
                </div>

                <div id="online-header">
                    <h1>Elektronický kalendář a online objednání</h1>

                    <span>Elektronický kalendář je zcela <b>zdarma</b> a je tak zcela na vás, zda ho využijete.
                        Můžete si do něj zapisovat objednané pacienty a ušetřit tak papíry.</span>
                    <br>
                    <br>
                    <span>Výběrem možnosti <b>online objednání</b> zveřejníte objednávací kalendář na vašem profilu a pacienti se k vám budou moci objednat sami a online.
                    Služba je zpoplatněna cenou <b>20Kč za objednávací den</b>.
                    <b style="color: #26A69A">První měsíc máte online objednání zdarma</b>.</span>
                    <br>
                    <br>
                    <span>Pokud o některou ze služeb máte zájem, tak prosím zaškrtněte tlačítko níže.
                        V opačném případě jej můžete ignorovat a pokračovat na další krok.</span>
                    <br>

                    <paper-checkbox id="onlineSection" checked="{{onlineSection}}">Chci využít službu elektronického kalendáře nebo online objednání.
                    </paper-checkbox>
                </div>
                <div class="subsection grid" hidden="[[!onlineSection]]">
                    <section>
                        <h2>Objednávací hodiny</h2>
                        <p>Vyplňte v zadaném formátu hodiny, na které je možné objednat.</p>
                        <template is="dom-repeat" items="[[officeData.generatorInfo.officeHours]]" as="entry">
                            <div>
                                <paper-checkbox checked="{{entry.available}}">[[getDayName(index)]]
                                </paper-checkbox>
                            </div>
                            <template is="dom-if" if="[[entry.available]]" restamp="true">
                                <paper-input value="{{entry.hours}}" auto-validate required
                                             placeholder="07:30-12:30,13:30-15:30"
                                             pattern="([0-9]|0[0-9]|1[0-9]|2[0-3]):[0-5][0-9]-([0-9]|0[0-9]|1[0-9]|2[0-3]):[0-5][0-9](,([0-9]|0[0-9]|1[0-9]|2[0-3]):[0-5][0-9]-([0-9]|0[0-9]|1[0-9]|2[0-3]):[0-5][0-9])*"
                                             prevent-invalid-input allowed-pattern="[0-9,-:]"></paper-input>
                            </template>
                        </template>
                    </section>
                    <section>
                        <h2>Délka návštěvy</h2>
                        <p>Zde zadejte odhad délky návštěvy pacienta v minutách. Podle této hodnoty a ordinačních
                            hodin určíme objednávací časy v kalendáři</p>
                        <paper-input type="number" label="Délka návštěvy" min="1" max="360" required auto-validate
                                     value="{{copyOfGeneratorInfo.visitLength}}">
                            <div suffix>min</div>
                        </paper-input>

                        <h2>Počet objednávacích dní</h2>
                        <p>Zadejte na jak daleko do budoucna se mohou pacienti objednat.<br>Pokud napíšete např. 7 dní,
                            tak nebude možné objednat se na 8. den a dále od dnešního data.
                        </p>
                        <paper-input type="number" label="Počet dní" min="7" max="360" required auto-validate
                                     value="{{copyOfGeneratorInfo.numberOfDays}}">
                            <div suffix>dní</div>
                        </paper-input>

                        <div id="online-booking-container">
                            <paper-checkbox id="online-booking-checkbox" checked="{{onlineBooking}}">
                                Chci využít online objednání
                            </paper-checkbox>
                        </div>
                        <div hidden="[[!onlineBooking]]">
                            <h2>První objednávací den</h2>
                            <p>Vyberte datum, od kdy chcete využívat online objednávání.</p>
                            <paper-datetime-picker-item required icon="icons:today"
                                                        placeholder="Vybrat datum"
                                                        default-time="00:00"
                                                        locale="cs"
                                                        date="{{fromDateTime}}"></paper-datetime-picker-item>

                            <h2>Manuální potvrzení při první návštěvě</h2>
                            <p>Zaškrtněte, pokud chcete, aby pacient při
                                prvním objednání nejprve musel zažádat o
                                vaše potvrzení. Poté, co pacient zažádá o potvrzení, vám přijde zpráva, ve které uvidíte
                                pacientovi osobní údaje
                                (jméno, adresa, datum narození), na jejichž základě umožníte pacientovi objednání či
                                naopak.
                                <br>
                                Při dalších návštěvách již potvrzeného pacienta nebude nutné vaše potvrzení.
                            </p>

                            <paper-checkbox checked="{{localOfficeData.manualConfirmation}}">
                                Vyžaduji manuální potvrzení
                            </paper-checkbox>
                        </div>
                    </section>
                </div>
            </form>
        </div>
    </template>

    <script>
        Polymer({
            is: 'third-view',

            behaviors: [FormValidationBehavior],

            properties: {
                days: {
                    type: Array,
                    value: ['Pondělí', 'Úterý', 'Středa', 'Čtvrtek', 'Pátek', 'Sobota', 'Neděle']
                }
            },

            getDayName: function (dayIndex) {
                return (this.days[dayIndex]);
            }
        });
    </script>
</dom-module>
