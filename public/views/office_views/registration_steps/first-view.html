<link rel="import" href="/bower_components/polymer/polymer.html">

<link rel="import" href="/bower_components/paper-input/paper-input.html">
<link rel="import" href="/bower_components/paper-dropdown-menu/paper-dropdown-menu.html">
<link rel="import" href="/bower_components/paper-listbox/paper-listbox.html">
<link rel="import" href="/bower_components/paper-item/paper-item.html">
<link rel="import" href="/bower_components/gold-email-input/gold-email-input.html">
<link rel="import" href="/bower_components/gold-phone-input/gold-phone-input.html">
<link rel="import" href="/bower_components/paper-button/paper-button.html">
<link rel="import" href="/bower_components/google-apis/google-maps-api.html">
<link rel="import" href="/bower_components/iron-flex-layout/iron-flex-layout.html">

<link rel="import" href="/styles/input-styles.html">
<link rel="import" href="/styles/layout-styles.html">
<link rel="import" href="/styles/button-styles.html">

<link rel="import" href="/behaviors/form-validation-behavior.html">

<dom-module id="first-view">
    <template>
        <style include="button-styles layout-styles input-styles">

            #next-step {
                float: right;
            }

            @media only screen and (max-width: 767px) {

                paper-button#next-step[responsive] {
                    position: absolute;
                }
            }


        </style>

        <google-maps-api id="map_api" api-key="AIzaSyAqsxSW1xtRQ5HPFA73iILCIkRj4stY4LI"></google-maps-api>

        <div class="main-frame">
                <form is="iron-form">
                    <div class="subsection grid">

                        <section>
                            <h2>Vaše jméno</h2>
                            <paper-input label="Jméno" minlength="1" maxlength="20" auto-validate
                                         error-message="Nelze ponechat prázdné" required
                                         value="{{officeData.fullInfo.name.firstName}}"></paper-input>
                            <paper-input label="Příjmení" minlength="1" auto-validate
                                         maxlength="80" error-message="Nelze ponechat prázdné"
                                         required value="{{officeData.fullInfo.name.lastName}}"></paper-input>
                            <h2>Adresa ordinace</h2>
                            <paper-input id="cinput" label="Město" value="{{officeData.fullInfo.address.city}}"
                                         minlength="1" maxlength="20" required auto-validate>
                            </paper-input>
                            <paper-input id="sinput" label="Ulice a číslo popisné"
                                         value="{{officeData.fullInfo.address.street}}"
                                         minlength="1" maxlength="80" required auto-validate></paper-input>
                        </section>
                        <section>
                            <h2>Vaše specializace v této ordinaci</h2>
                            <paper-dropdown-menu label="Specializace">
                                <paper-listbox class="dropdown-content"
                                               selected="{{officeData.fullInfo.specialization}}">
                                    <template is="dom-repeat" items="[[specializations]]" as="entry">
                                        <paper-item>[[entry]]</paper-item>
                                    </template>
                                </paper-listbox>
                            </paper-dropdown-menu>

                            <h2>Vřejné informace profilu</h2>
                            <p>Informace budou veřejně k vidění na vašem profilu. Údaje jsou
                                dobrovolné a nemusíte je tak vyplňovat. </p>
                            <gold-phone-input id="phone_id" country-code="420" label="Telefonní číslo"
                                              phone-number-pattern="XXX-XXX-XXX" auto-validate
                                              value="{{officeData.fullInfo.phoneNumber}}">
                            </gold-phone-input>
                            <gold-email-input id="email_id" label="Email" value="{{officeData.fullInfo.email}}"
                                              auto-validate></gold-email-input>

                        </section>
                    </div>
                </form>
            <paper-button id="next-step" raised responsive>Další krok</paper-button>
        </div>
    </template>

    <script>
        Polymer({
            is: 'first-view',

            behaviors: [FormValidationBehavior],

            properties: {
                specializations: {
                    type: Array,
                    value: ['Adiktologie',
                        'Alergologie',
                        'Algeziologie',
                        'Anesteziologie',
                        'Angiologie',
                        'Cévní chirurgie',
                        'Cytologie',
                        'Dermatologie',
                        'Dermatovenerologie',
                        'Dětská a dorostová psychiatrie',
                        'Dětská dermatologie',
                        'Dětská gynekologie',
                        'Dětská chirurgie',
                        'Dětská kardiologie',
                        'Dětská neurologie',
                        'Dětská otorinolaryngologie',
                        'Dětská psychologie',
                        'Dětská urologie',
                        'Dětské lékařství',
                        'Diabetologie',
                        'Dorostové lékařství',
                        'Endokrinologie',
                        'Ergoterapeut',
                        'Foniatrie',
                        'Fyzioterapeut',
                        'Gastroenterologie',
                        'Genetika',
                        'Geriatrie',
                        'Gynekologie a porodnictví',
                        'Hematologie',
                        'Hrudní chirurgie',
                        'Chirurgie',
                        'Infekční lékařství',
                        'Kardiochirurgie',
                        'Kardiologie',
                        'Logopedie',
                        'Imunologie',
                        'Nefrologie',
                        'Neonatologie',
                        'Neurochirurgie',
                        'Neurologie',
                        'Nukleární medicína',
                        'Nutriční terapeut',
                        'Oční lékař',
                        'Oftalmologie',
                        'Orální a maxilofaciální chirurgie',
                        'Ortodoncie',
                        'Ortopedie',
                        'Otorinolaryngologie',
                        'Paliativní medicína',
                        'Patologická anatomie',
                        'Patologie',
                        'Plastická chirurgie',
                        'Pneumologie a ftizeologie',
                        'Popáleninová medicína',
                        'Porodní asistentka',
                        'Praktické lékařství pro děti a dorost',
                        'Praktické lékařství pro dospělé',
                        'Psychiatrie',
                        'Psychologie',
                        'Psychoterapie',
                        'Onkologie',
                        'Sexuologie',
                        'Soudní lékařství',
                        'Stomatologie',
                        'Tělovýchovné lékařství',
                        'Transfúzní lékařství',
                        'Úrazová chirurgie',
                        'Urgentní medicína',
                        'Urologie',
                        'Jiné'
                    ]
                }
            },

            setCoordinates: function (addressObject) {
                var address = addressObject.city + " " + addressObject.street;
                var api = this.$.map_api.api;
                var geocoder = new api.Geocoder();
                if (geocoder) {
                    geocoder.geocode({'address': address}, function (result, status) {
                        if (status == api.GeocoderStatus.OK && status != api.GeocoderStatus.ZERO_RESULTS) {
                            var location = result[0].geometry.location;
                            this.set('officeData.fullInfo.coordinates.latitude', location.lat());
                            this.set('officeData.fullInfo.coordinates.longitude', location.lng());
                            this.fire('register-office');
                        } else {
                            this.fire('change-route', {url: '/office/registration/coordinates'});
                        }
                    }.bind(this));
                } else {
                    this.fire('change-route', {url: '/office/registration/coordinates'});
                }
            }
        });
    </script>
</dom-module>
