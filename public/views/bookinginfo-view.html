<link rel="import" href="../bower_components/polymer/polymer.html">

<link rel="import" href="/bower_components/paper-input/paper-textarea.html">
<link rel="import" href="/bower_components/paper-button/paper-button.html">
<link rel="import" href="/bower_components/gold-email-input/gold-email-input.html">
<link rel="import" href="/bower_components/iron-flex-layout/iron-flex-layout.html">
<link rel="import" href="/bower_components/iron-media-query/iron-media-query.html">
<link rel="import" href="/bower_components/polymerfire/firebase-app-script.html">
<link rel="import" href="/bower_components/iron-form/iron-form.html">
<link rel="import" href="/bower_components/iron-icons/iron-icons.html">

<link rel="import" href="/styles/input-styles.html">
<link rel="import" href="/styles/layout-styles.html">

<dom-module id="bookinginfo-view">
    <template>
        <style include="layout-styles input-styles">
            :host {
                display: block;
                color: #252526;
            }

            .light-green-background {
                background-color: var(--app-light-green-color);
                color: #fff !important;
            }

            .light-blue-background {
                background-color: var(--app-light-blue-color);
                color: #fff !important;
            }

            a {
                text-decoration: none;
                color: var(--app-light-green-color);
                font-weight: 500;
            }

            a:hover {
                text-decoration: underline;
            }

            paper-button {
                color: #fff;
                background-color: var(--app-light-green-color);
                margin: 1em auto;
                padding: 1em 1.5em;
            }

            h1 {
                letter-spacing: 0.03em;
                font-size: 1.5em;
                margin-top: 0;
                margin-bottom: 1.5em;
            }

            paper-button {
                transition: all 0.3s cubic-bezier(.25, .8, .25, 1);
                box-shadow: 0 3px 6px rgba(0, 0, 0, 0.16), 0 3px 6px rgba(0, 0, 0, 0.23);
            }

            .main-frame {
                max-width: 1380px;
                font-weight: lighter;
                padding: 0;
                margin: 0 auto;
            }

            .grid section {
                padding: 4em 5%;
                margin: 0 !important;
                position: relative;
            }

            section > p {
                font-size: 1.2em;
                line-height: 1.65em;
                font-weight: 100;
            }

            /******************/

            #who-can-book-section {
                margin-bottom: 0;
                padding-top: 3em;
                padding-bottom: 3em;
                position: relative;
            }

            #who-can-book-section img {
                max-width: 300px;
            }

            /********************/
            #officeCalendar {
                padding: 5em 6% 0 3em;
            }

            #officeCalendar h1 {
                font-size: 1.6em;

            }

            #officeCalendar p {
                font-size: 1.4em;

            }


            #officeCalendar img {
                max-width: 100%;
                margin-top: 5em;
                margin-bottom: -8px;
            }

            #officeCalendar .text-section {
                max-width: 880px;
                margin: 0 auto;
            }

            /****************/

            .presentation-img {
                position: absolute;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                margin: auto;
            }

            .img-section {
                text-align: center;
            }

            /***** OFFICE PRESENTATION ********/

            #presentation {
                 padding-top: 2em;
             }

            #presentation .text-section{
                min-height: 450px;

            }

            /** HOLIDAY ***/

            #holiday {
                padding: 4em 0;
            }

            #holiday img {
                max-width: 150px
            }

            /*** QUESTION FORM ***/

            #question-container {
                padding: 3em 1.5em;
            }

            #question-container h1 {
                letter-spacing: 0.02em;
                margin-top: 0.5em;

            }

            form {
                max-width: 600px;
                margin: 0 auto;
            }


            #calendar-img {
                max-height: 490px;
                max-width: 490px;
            }


            #why-booking-section {
                color: #fff;
                text-align: center;
                padding: 4em 2em 3em 2em;
            }


            #why-booking-section h1 img {
                position: absolute;
                left: -4.2em;
                top: -0.5em;
                width: 3em;
            }

            .why-booking-img {
                max-height: 120px;
            }

            .header-div {
                text-align: center;
            }

            #why-booking-section .header-div h2 {
                border-radius: 10em;
                text-transform: uppercase;
                font-size: 1.1em;
                width: 13em;
                margin: 0 auto 1em auto;
            }

            #why-booking-section .description-div {
                text-align: left;
                font-size: 1.1em;
                letter-spacing: 0.025em;
                line-height: 1.5em;
            }

            /****** FLEX LAYOUT ****/

            .booking-flex-horizontal > section {
                text-align: justify;
            }
            /*
           ---- MEDIA ----
           */


            @media (max-width: 980px) {

                #officeCalendar {
                    padding-bottom: 4em;
                }

                #holiday {
                    padding-top: 2em;
                    padding-bottom: 2em;
                }

                #presentation img {
                    max-width: 300px;
                }

                #presentation .text-section{
                    min-height: inherit;
                }
            }


            @media (max-width: 716px) {

                :host {
                    font-size: 0.85em;
                }

                .grid section {
                    padding: 7% 5%;
                }
                .presentation-img {
                    position: static;
                    max-width: 150px;
                    max-height: 150px;
                }

                .why-booking-img {
                    max-height: 80px;
                }
            }

            @media (max-width: 980px) {
                .booking-flex-horizontal {
                    @apply(--layout-vertical);
                }
            }


        </style>

        <iron-media-query query="max-width:460px" query-matches="{{mobileScreen}}"></iron-media-query>
        <iron-media-query query="max-width:716px" query-matches="{{smallScreen}}"></iron-media-query>
        <iron-media-query query="max-width:980px" query-matches="{{mediumScreen}}"></iron-media-query>


        <section id="why-booking-section" class="light-blue-background">
            <h1>
                PŘIDEJTE SE A OBJEDNÁVEJTE PACIENTY ONLINE
            </h1>
            <div class="main-frame booking-flex-horizontal grid">
                <section>
                    <div class="header-div">
                        <img class="why-booking-img" src="../images/docinfo/save-time.png">
                        <h2>Ušetříte si čas</h2>
                    </div>
                    <div class="description-div">
                        <p>Nezatěžujte sebe nebo Vaší sestru vyřizováním telefonátů. Vaši pacienti se objednají sami,
                            můžete se tak plně věnovat
                            práci, která má smysl.</p>
                    </div>
                </section>
                <section>
                    <div class="header-div">
                        <img class="why-booking-img" src="../images/docinfo/save-work.png">
                        <h2>Ušetříte si práci</h2>
                    </div>
                    <div class="description-div">
                        <p>Vytvoříme Vám kalendář přesně podle Vašich potřeb. Nemusíte listovat v papírech, vše budete
                            mít přehledně na jednom
                            místě.</p>
                    </div>
                </section>
                <section>
                    <div class="header-div">
                        <img class="why-booking-img" src="../images/docinfo/help-patients.png">
                        <h2>Pomůžete pacientům</h2>
                    </div>
                    <div class="description-div">
                        <p>Pacienti se chtějí objednat kdy se jim to hodí. Dopřejte jim čas na rozmyšlenou a nenuťte je
                            telefonovat během
                            Vašich ordinačních hodin.</p>
                    </div>
                </section>
            </div>
        </section>

        <section id="presentation">
            <div class="main-frame grid">
                <section class="text-section">
                    <h1>
                        VYTVOŘTE SI KALEDNÁŘ NA MÍRU
                    </h1>
                    <p>Vytvoříte si kalednář podle sebe. Každý den můžete mít jiné termíny. Navíc si můžete zvolit, na jak dlouho dopředu se Vám budou termíny tvořit.</p>
                    <p>Pacienti se pak pohodlně objednají na vybraný termín. Případně Vám mohou poslat zprávu.</p>
                </section>

                <section class="img-section">
                    <img id="calendar-img" class="presentation-img" src="../images/bookinginfo/calendar.png">
                </section>
            </div>
        </section>

        <section class="light-blue-background" id="who-can-book-section">
            <div class="main-frame grid">
                <section class="img-section" hidden="[[mediumScreen]]">
                    <img class="presentation-img" src="../images/bookinginfo/access.png">
                </section>
                <section id="office-calendar-section">
                    <h1 id="scrollTest">KDO SE K VÁM MŮŽE OBJEDNAT?</h1>
                    <p>Objednat se mohou jen pacienti, kteří jsou u nás zaregistrovaní.
                        Navíc si můžete sami kontrolovat,
                        kteří pacienti se k Vám mohou objednat a kteří ne. U každého pacienta uvidíte
                        informace k jeho identifikaci.
                        Můžete tak dovolit objednání jen svým pacientům.
                    </p>
                </section>
            </div>
        </section>

        <section class="" id="holiday">
            <div class="main-frame grid">
                <section>
                    <h1 id="">DOVOLENÁ PROPOJENA S KALENDÁŘEM</h1>
                    <p>Potřebujete si vzít dovolenou a chcete zrušit objednávání? Náš kalendář je perfektně propojen s
                        dovolenou. Automaticky Vám zrušíme objednávací hodiny když nebudete v ordinaci.
                    </p>
                </section>
                <section class="img-section" hidden="[[mediumScreen]]">
                    <img class="presentation-img" src="../images/bookinginfo/holiday.png">
                </section>
            </div>
        </section>

        <section id="officeCalendar" class="light-green-background">
            <div class="main-frame">
                <div class="text-section">
                    <h1>VŠE MÁTE V PŘEHLEDNÉM KALENDÁŘI</h1>
                    <p>V elektronickém kalendáři vidíte všechny objednané pacienty. Můžete zde rušit schůzky a objednávací časy.
                        Můžete i sami přidávat nová objednání. </p>
                </div>
                <section class="img-section" hidden="[[mediumScreen]]">
                    <img class="" src="../images/bookinginfo/office-calendar-computer.png">
                </section>

            </div>
        </section>


        <div id="question-container" hidden="[[messageSent]]">
            <form id="docinfo_form" is="iron-form">
                <h1>MÁTE ZÁJEM NEBO JINÝ DOTAZ? NAPIŠTĚ NÁM</h1>
                <gold-email-input id="email_input" error-message="Špatný formát"
                                  label="Vaše emailová adresa" required>
                </gold-email-input>
                <paper-textarea id="message_input" label="Vaše zpráva" char-counter
                                error-message="Zpráva nesmí být prázdná"
                                maxlength="2000" required></paper-textarea>
                <paper-button raised on-tap="send">Odeslat</paper-button>
            </form>
        </div>
    </template>

    <script>
        Polymer({
            is: 'bookinginfo-view',

            properties: {
                database: {
                    type: Object,
                    value: function () {
                        return firebase.apps[0].database();
                    }
                },

                messageSent: {
                    type: Boolean,
                    value: false
                }

            },

            send: function () {
                //  paper-textarea was not detected by form validation, so I'm validating the inputs manually
                if (this.$.email_input.validate() && this.$.message_input.validate()) {
                    this.sendQuestion();
                }
            },

            sendQuestion: function () {

                var email = this.$.email_input.value,
                    message = this.$.message_input.value,
                    db = firebase.apps[0].database();

                db.ref('/docInfoQuestions/').push({
                    "email": email,
                    "message": message
                }).then(function () {
                    this.fire("show-toast", {text: "Zpráva odeslána"});
                    this.messageSent = true;
                }.bind(this), function () {
                    this.fire("show-dialog", {
                        path: "", viewName: "genericdialog", open: true,
                        data: {
                            text: 'Při ukládání dat se vyskytla chyba. Zkuste to prosím znovu.',
                            buttonText: 'Zavřít'
                        }
                    });
                }.bind(this));
            }

        });
    </script>
</dom-module>
